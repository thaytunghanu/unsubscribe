<div id="unsubscribe-box" style="text-align: center; margin: 2rem 0">
  <p><strong>ğŸ’” Há»§y nháº­n thÃ´ng bÃ¡o bÃ i viáº¿t má»›i qua email:</strong></p>
  <div style="display: inline-flex; gap: 0.5rem; flex-wrap: wrap; justify-content: center;">
    <input type="email" id="unsubscribeInput" placeholder="Nháº­p email Ä‘á»ƒ há»§y" required
      style="padding: 0.5rem; width: 300px; border-radius: 4px; border: 1px solid #ccc;" />
    <button onclick="unsubscribeEmail()" style="padding: 0.5rem 1rem; background-color: #d9534f; color: white; border: none; border-radius: 4px; cursor: pointer;">
      Há»§y Ä‘Äƒng kÃ½
    </button>
  </div>
  <p id="unsubscribeMsg" style="margin-top: 1rem; color: green;"></p>
</div>

<script>
  function isValidEmail(email) {
    // Regex kiá»ƒm tra Ä‘á»‹nh dáº¡ng email
    const re = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    return re.test(String(email).toLowerCase());
  }

  function unsubscribeEmail() {
    const email = document.getElementById("unsubscribeInput").value.trim();
    const msg = document.getElementById("unsubscribeMsg");

    if (!email) {
      msg.textContent = "Vui lÃ²ng nháº­p email.";
      msg.style.color = "red";
      return;
    }

    if (!isValidEmail(email)) {
      msg.textContent = "Äá»‹a chá»‰ email khÃ´ng há»£p lá»‡.";
      msg.style.color = "red";
      return;
    }

    fetch("https://script.google.com/macros/s/AKfycbxVis-ZfJvsl_WFwXLNdFpgldVGp55166-qF6tT-c2ZTkOziWwh81y95B8AZBMskQqAUg/exec", {
      method: "POST",
      mode: "no-cors",
      headers: { "Content-Type": "application/x-www-form-urlencoded" },
      body: `email=${encodeURIComponent(email)}&action=unsubscribe`
    })
    .then(() => {
      msg.textContent = "âœ… Há»§y Ä‘Äƒng kÃ½ thÃ nh cÃ´ng!";
      msg.style.color = "green";
      document.getElementById("unsubscribeInput").value = "";
    })
    .catch(() => {
      msg.textContent = "âŒ Lá»—i khi xá»­ lÃ½.";
      msg.style.color = "red";
    });
  }
</script>
